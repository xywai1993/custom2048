webpackJsonp([1],{"7zYg":function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r("7+uW"),n=r("mvHQ"),o=r.n(n),a={LEFT:37,UP:38,RIGHT:39,DOWN:40},s={data:function(){return{emptyGrids:null,grids:null,listener:function(){var e=this,t=void 0,r=void 0;return{touchstart:function(e){e.preventDefault(),t=e.touches[0].pageX,r=e.touches[0].pageY},touchend:function(i){i.preventDefault();var n=null,o=i.changedTouches[0].pageX,a=i.changedTouches[0].pageY,s=o-t,c=a-r;Math.abs(s)<=5&&Math.abs(c)<=5||(Math.abs(s)>Math.abs(c)?s>0?n="RIGHT":s<0&&(n="LEFT"):Math.abs(s)<Math.abs(c)&&(c>0?n="DOWN":c<0&&(n="UP")),e.$emit("movingtiles",n))},keydown:function(t){switch(t.keyCode){case a.UP:e.$emit("movingtiles","UP");break;case a.RIGHT:e.$emit("movingtiles","RIGHT");break;case a.DOWN:e.$emit("movingtiles","DOWN");break;case a.LEFT:e.$emit("movingtiles","LEFT")}}}}.call(this)}},methods:{start:function(){var e=this;this.$nextTick(function(){var t=e.$refs.tiles.getContext("2d");t.clearRect(0,0,300,300),e.grids=JSON.parse(o()(e.emptyGrids)),e.eventListenerSwitch("off"),e.eventListenerSwitch(),e.generateGridNumber(t),e.generateGridNumber(t)})},initChessBoard:function(){var e=this;this.$nextTick(function(){var t=e.$refs.chessBoard.getContext("2d");t.fillStyle="#bbada0",t.fillRect(0,0,300,300);for(var r=[],i=0;i<4;i++){r[i]=[];for(var n=0;n<4;n++){r[i][n]=null;var o=e.getBoundingClientRect(i,n);e.drawRoundingRect({ctx:t,rect:o})}}e.emptyGrids=r})},drawGameover:function(e){e.fillStyle="rgba(0,0,0,0.6)",e.fillRect(0,0,300,300),e.fillStyle="white",e.font="Microsoft YaHei bold 60px";var t=e.measureText("游戏结束");e.fillText("游戏结束",150-t.width/2,150),this.eventListenerSwitch("off")},drawRoundingRect:function(e){var t=e.ctx,r=e.rect,i=e.radius,n=void 0===i?6:i,o=e.fillStyle,a=void 0===o?"#ccc0b3":o,s=r.left,c=r.right,l=r.top,h=r.bottom;t.fillStyle=a,t.beginPath(),t.moveTo(s,l+n),t.quadraticCurveTo(s,l,s+n,l),t.lineTo(c-n,l),t.quadraticCurveTo(c,l,c,l+n),t.lineTo(c,h-n),t.quadraticCurveTo(c,h,c-n,h),t.lineTo(s+n,h),t.quadraticCurveTo(s,h,s,h-n),t.closePath(),t.fill()},drawGridNumber:function(e,t){var r=t.val,i=t.rect,n=this.getNumberStyle(r),o=n.backgroundColor,a=n.color,s=n.fontSize;this.drawRoundingRect({ctx:e,rect:i,fillStyle:o}),e.fillStyle=a,e.font="bold "+s+"px Microsoft YaHei";var c=e.measureText(r),l=i.left+(i.right-i.left)/2-c.width/2,h=i.bottom-(i.bottom-i.top)/2+s/3;e.fillText(t.val,l,h)},generateGridNumber:function(e){if(this.nospace())this.drawGameover(e);else for(;;){var t=Math.floor(4*Math.random()),r=Math.floor(4*Math.random());if(null===this.grids[t][r]){var i=2*Math.ceil(2*Math.random());this.grids[t][r]={rect:this.getBoundingClientRect(t,r),val:i},this.drawGridNumber(e,this.grids[t][r]),this.$emit("changescore",i);break}}},getBoundingClientRect:function(e,t){var r=12*(e+1)+60*e,i=12*(t+1)+60*t;return{left:r,top:i,right:r+60,bottom:i+60,height:60,width:60}},getNumberStyle:function(e){var t="black",r="white",i=46;switch(e){case 2:t="#eee4da",r="#776e50";break;case 4:t="#ede0c8",r="#776e50";break;case 8:t="#f2b179";break;case 16:t="#f59563";break;case 32:t="#f67c5f";break;case 64:t="#f65e3b";break;case 128:t="#edcf72",i="32";break;case 256:t="#edcc61",i="32";break;case 512:t="#9c0",i="32";break;case 1024:t="#33b5e5",i="20";break;case 2048:t="#09c",i="20"}return{backgroundColor:t,color:r,fontSize:i}},nospace:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)if(null===this.grids[e][t])return!1;return!0},eventListenerSwitch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"on";this.$nextTick(function(){var r=e.$refs.tiles;"on"===t?(r.addEventListener("touchstart",e.listener.touchstart,!1),r.addEventListener("touchend",e.listener.touchend,!1),document.addEventListener("keydown",e.listener.keydown,!1)):(r.removeEventListener("touchstart",e.listener.touchstart,!1),r.removeEventListener("touchend",e.listener.touchend,!1),document.removeEventListener("keydown",e.listener.keydown,!1))})},moving:function(e){var t=this,r=this.$refs.tiles.getContext("2d");"RIGHT"===e?this.moveRight():"LEFT"===e?this.moveLeft():"UP"===e?this.moveUp():this.moveDown(),r.clearRect(0,0,300,300);for(var i=0;i<4;i++)for(var n=0;n<4;n++)this.grids[i][n]&&this.drawGridNumber(r,this.grids[i][n]);setTimeout(function(){t.generateGridNumber(r)},200)},moveLeft:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)for(var r=this.grids[e][t],i=e+1;i<4;){var n=this.mergeTile({currentTile:r,row:e,col:t},{i:i,j:t});if(!0===n)break;r=n,i++}},moveRight:function(){for(var e=3;e>=0;e--)for(var t=0;t<4;t++)for(var r=this.grids[e][t],i=e-1;i>=0;){var n=this.mergeTile({currentTile:r,row:e,col:t},{i:i,j:t});if(!0===n)break;r=n,i--}},moveUp:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)for(var r=this.grids[e][t],i=t+1;i<4;){var n=this.mergeTile({currentTile:r,row:e,col:t},{i:e,j:i});if(!0===n)break;r=n,i++}},moveDown:function(){for(var e=0;e<4;e++)for(var t=3;t>=0;t--)for(var r=this.grids[e][t],i=t-1;i>=0;){var n=this.mergeTile({currentTile:r,row:e,col:t},{i:e,j:i});if(!0===n)break;r=n,i--}},mergeTile:function(e,t){var r=e.currentTile,i=e.row,n=e.col,o=t.i,a=t.j,s=!1;return r?this.grids[o][a]&&(this.grids[o][a].val===r.val&&(r.val=2*r.val,this.grids[o][a]=null),s=!0):this.grids[o][a]&&(r=this.grids[o][a],this.grids[o][a]=null),r&&(this.grids[i][n]={val:r.val,rect:this.getBoundingClientRect(i,n)}),!!s||r}},mounted:function(){this.initChessBoard(),this.$on("movingtiles",this.moving),this.start()}};var c={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"Custom2048"},[t("canvas",{ref:"chessBoard",attrs:{width:"300px",height:"300px"}}),this._v(" "),t("canvas",{ref:"tiles",attrs:{width:"300px",height:"300px"}})])},staticRenderFns:[]};var l={name:"App",components:{Custom2048:r("VU/8")(s,c,!1,function(e){r("7zYg")},null,null).exports},data:function(){return{score:0,maxScore:window.localStorage.getItem("custom2048_score")||0}},watch:{score:function(e){e>this.maxScore&&(this.maxScore=e,window.localStorage.setItem("custom2048_score",e))}},methods:{handleRestart:function(){var e=this;this.$nextTick(function(){e.score=0,e.$refs.custom2048.start()})},handleChangeScore:function(e){this.score+=e},handleGameover:function(){}}},h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Custom2048",{ref:"custom2048",staticClass:"custom2048-outer-container",on:{changescore:e.handleChangeScore,gameover:e.handleGameover}}),e._v(" "),r("div",{staticClass:"menu-container"},[r("div",{staticClass:"score-container"},[r("div",{staticClass:"block current-score"},[e._v("\n        得分\n        "),r("span",[e._v(e._s(e.score))])]),e._v(" "),r("div",{staticClass:"block history-score"},[e._v("\n        最高分\n        "),r("span",[e._v(e._s(e.maxScore))])])]),e._v(" "),r("span",{staticClass:"block restart",on:{click:e.handleRestart}},[e._v("重新开始")])])],1)},staticRenderFns:[]};var u=r("VU/8")(l,h,!1,function(e){r("oYRI")},null,null).exports;i.a.config.productionTip=!1,new i.a({el:"#app",components:{App:u},template:"<App/>"})},oYRI:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2294bf49ffa2ff4728a9.js.map