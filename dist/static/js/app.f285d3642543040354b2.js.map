{"version":3,"sources":["webpack:///src/components/Custom2048/index.vue","webpack:///./src/components/Custom2048/index.vue?7ddd","webpack:///./src/components/Custom2048/index.vue","webpack:///src/App.vue","webpack:///./src/App.vue?e5ee","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["KEYDOWN","LEFT","UP","RIGHT","DOWN","Custom2048","data","emptyGrids","grids","listener","_this5","this","startX","startY","touchstart","e","preventDefault","touches","pageX","pageY","touchend","direction","endX","changedTouches","endY","horizontal","vertical","Math","abs","$emit","keydown","keyCode","call","methods","start","_this","$nextTick","ctx","$refs","tiles","getContext","clearRect","JSON","parse","stringify_default","eventListenerSwitch","generateGridNumber","initChessBoard","_this2","chessBoard","fillStyle","fillRect","i","j","rect","getBoundingClientRect","drawRoundingRect","drawGameover","font","text","measureText","fillText","width","options","_options$radius","radius","undefined","_options$fillStyle","left","right","top","bottom","beginPath","moveTo","quadraticCurveTo","lineTo","closePath","fill","drawGridNumber","grid","val","_getNumberStyle","getNumberStyle","backgroundColor","color","fontSize","x","y","nospace","row","floor","random","col","ceil","height","number","_this3","sw","arguments","length","canvas","addEventListener","document","removeEventListener","moving","_this4","moveRight","moveLeft","moveUp","moveDown","setTimeout","currentTile","i1","mergeTile","ROW","j1","COL","current","neighbor","isMerge","mounted","$on","components_Custom2048","render","_h","$createElement","_c","_self","staticClass","ref","attrs","_v","staticRenderFns","App","name","components","__webpack_require__","normalizeComponent","ssrContext","score","maxScore","window","localStorage","getItem","watch","setItem","handleRestart","custom2048","handleChangeScore","awardedMarks","handleGameover","selectortype_template_index_0_src_App","_vm","id","on","changescore","gameover","_s","click","src_App","App_normalizeComponent","vue_esm","config","productionTip","el","template"],"mappings":"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","file":"static/js/app.f285d3642543040354b2.js","sourcesContent":["<template>\n  <div class=\"Custom2048\">\n    <canvas ref=\"chessBoard\" width=\"300px\" height=\"300px\"></canvas>\n    <canvas ref=\"tiles\" width=\"300px\" height=\"300px\"></canvas>\n  </div>\n</template>\n<script>\nconst ROW = 4\nconst COL = 4\nconst BORDER_WIDTH = 12\nconst CELL_WIDTH = 60\n\nconst KEYDOWN = {\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40\n}\n\nexport default {\n  data () {\n    return {\n      emptyGrids: null,\n      grids: null,\n      listener: getListener.call(this)\n    }\n  },\n  methods: {\n    start () {\n      this.$nextTick(() => {\n        let canvas = this.$refs.tiles\n        let ctx = canvas.getContext('2d')\n        // 清除tiles\n        ctx.clearRect(0, 0, 300, 300)\n        // 初始化grids数组\n        this.grids = JSON.parse(JSON.stringify(this.emptyGrids))\n\n        // 取消事件监听\n        this.eventListenerSwitch('off')\n        // 添加监听事件\n        this.eventListenerSwitch()\n\n        // 随机生成数字\n        this.generateGridNumber(ctx)\n        this.generateGridNumber(ctx)\n      })\n    },\n    initChessBoard () {\n      this.$nextTick(() => {\n        let chessBoard = this.$refs.chessBoard\n        let ctx = chessBoard.getContext('2d')\n        ctx.fillStyle = '#bbada0'\n        ctx.fillRect(0, 0, 300, 300)\n        let grids = []\n\n        for (let i = 0; i < ROW; i++) {\n          grids[i] = []\n          for (let j = 0; j < COL; j++) {\n            grids[i][j] = null\n            let rect = this.getBoundingClientRect(i, j)\n            this.drawRoundingRect({ctx, rect})\n          }\n        }\n        this.emptyGrids = grids\n      })\n    },\n    drawGameover (ctx) {\n      let gameoverText = '游戏结束'\n      ctx.fillStyle = 'rgba(0,0,0,0.6)'\n      ctx.fillRect(0, 0, 300, 300)\n      ctx.fillStyle = 'white'\n      ctx.font = 'Microsoft YaHei bold 60px'\n      let text = ctx.measureText(gameoverText)\n      ctx.fillText(gameoverText, 150 - text.width / 2, 150)\n      this.eventListenerSwitch('off')\n    },\n    drawRoundingRect (options) {\n      // 圆角矩形...\n      let {ctx, rect, radius = 6, fillStyle = '#ccc0b3'} = options\n      let {left, right, top, bottom} = rect\n      ctx.fillStyle = fillStyle\n      ctx.beginPath()\n      ctx.moveTo(left, top + radius)\n      ctx.quadraticCurveTo(left, top, left + radius, top)\n      ctx.lineTo(right - radius, top)\n      ctx.quadraticCurveTo(right, top, right, top + radius)\n      ctx.lineTo(right, bottom - radius)\n      ctx.quadraticCurveTo(right, bottom, right - radius, bottom)\n      ctx.lineTo(left + radius, bottom)\n      ctx.quadraticCurveTo(left, bottom, left, bottom - radius)\n      ctx.closePath()\n      ctx.fill()\n    },\n    drawGridNumber (ctx, grid) {\n      let {val, rect} = grid\n      let {backgroundColor, color, fontSize} = this.getNumberStyle(val)\n\n      this.drawRoundingRect({ctx, rect, fillStyle: backgroundColor})\n\n      // draw text\n      ctx.fillStyle = color\n      ctx.font = `bold ${fontSize}px Microsoft YaHei`\n      let text = ctx.measureText(val)\n      let x = rect.left + (rect.right - rect.left) / 2 - text.width / 2\n      let y = rect.bottom - (rect.bottom - rect.top) / 2 + fontSize / 3\n      ctx.fillText(grid.val, x, y)\n    },\n    generateGridNumber (ctx) {\n      if (this.nospace()) {\n        this.drawGameover(ctx)\n        return\n      }\n      while (true) {\n        let row = Math.floor(Math.random() * ROW)\n        let col = Math.floor(Math.random() * COL)\n        if (this.grids[row][col] === null) {\n          let val = Math.ceil(Math.random() * 2) * 2\n          this.grids[row][col] = {\n            rect: this.getBoundingClientRect(row, col),\n            val\n          }\n          this.drawGridNumber(ctx, this.grids[row][col])\n\n          this.$emit('changescore', val)\n          break\n        }\n      }\n    },\n    getBoundingClientRect (row, col) {\n      let left = (row + 1) * BORDER_WIDTH + CELL_WIDTH * row\n      let top = (col + 1) * BORDER_WIDTH + CELL_WIDTH * col\n      return {\n        left,\n        top,\n        right: left + CELL_WIDTH,\n        bottom: top + CELL_WIDTH,\n        height: CELL_WIDTH,\n        width: CELL_WIDTH\n      }\n    },\n    getNumberStyle (number) {\n      let backgroundColor = 'black'\n      let color = 'white'\n      let fontSize = 46\n      switch (number) {\n        case 2:\n          backgroundColor = '#eee4da'\n          color = '#776e50'\n          break\n        case 4:\n          backgroundColor = '#ede0c8'\n          color = '#776e50'\n          break\n        case 8:\n          backgroundColor = '#f2b179'\n          break\n        case 16:\n          backgroundColor = '#f59563'\n          break\n        case 32:\n          backgroundColor = '#f67c5f'\n          break\n        case 64:\n          backgroundColor = '#f65e3b'\n          break\n        case 128:\n          backgroundColor = '#edcf72'\n          fontSize = '32'\n          break\n        case 256:\n          backgroundColor = '#edcc61'\n          fontSize = '32'\n          break\n        case 512:\n          backgroundColor = '#9c0'\n          fontSize = '32'\n          break\n        case 1024:\n          backgroundColor = '#33b5e5'\n          fontSize = '20'\n          break\n        case 2048:\n          backgroundColor = '#09c'\n          fontSize = '20'\n          break\n      }\n      return {\n        backgroundColor,\n        color,\n        fontSize\n      }\n    },\n    nospace () {\n      for (let i = 0; i < ROW; i++) {\n        for (let j = 0; j < COL; j++) {\n          if (this.grids[i][j] === null) {\n            return false\n          }\n        }\n      }\n      return true\n    },\n    eventListenerSwitch (sw = 'on') {\n      this.$nextTick(() => {\n        let canvas = this.$refs.tiles\n        if (sw === 'on') {\n          canvas.addEventListener('touchstart', this.listener.touchstart, false)\n          canvas.addEventListener('touchend', this.listener.touchend, false)\n          document.addEventListener('keydown', this.listener.keydown, false)\n        } else {\n          canvas.removeEventListener('touchstart', this.listener.touchstart, false)\n          canvas.removeEventListener('touchend', this.listener.touchend, false)\n          document.removeEventListener('keydown', this.listener.keydown, false)\n        }\n      })\n    },\n    moving (direction) {\n      let ctx = this.$refs.tiles.getContext('2d')\n      if (direction === 'RIGHT') {\n        this.moveRight()\n      } else if (direction === 'LEFT') {\n        this.moveLeft()\n      } else if (direction === 'UP') {\n        this.moveUp()\n      } else {\n        this.moveDown()\n      }\n\n      ctx.clearRect(0, 0, 300, 300)\n      for (let i = 0; i < ROW; i++) {\n        for (let j = 0; j < COL; j++) {\n          if (this.grids[i][j]) {\n            this.drawGridNumber(ctx, this.grids[i][j])\n          }\n        }\n      }\n      setTimeout(() => {\n        this.generateGridNumber(ctx)\n      }, 200)\n    },\n    moveLeft () {\n      for (let i = 0; i < ROW; i++) {\n        for (let j = 0; j < COL; j++) {\n          let currentTile = this.grids[i][j]\n          let i1 = i + 1\n          while (i1 < ROW) {\n            let mergeTile = this.mergeTile({currentTile, row: i, col: j}, {i: i1, j})\n            if (mergeTile === true) {\n              break\n            } else {\n              currentTile = mergeTile\n              i1++\n            }\n          }\n        }\n      }\n    },\n    moveRight () {\n      for (let i = ROW - 1; i >= 0; i--) {\n        for (let j = 0; j < COL; j++) {\n          let currentTile = this.grids[i][j]\n          let i1 = i - 1\n          while (i1 >= 0) {\n            let mergeTile = this.mergeTile({currentTile, row: i, col: j}, {i: i1, j})\n            if (mergeTile === true) {\n              break\n            } else {\n              currentTile = mergeTile\n              i1--\n            }\n          }\n        }\n      }\n    },\n    moveUp () {\n      for (let i = 0; i < ROW; i++) {\n        for (let j = 0; j < COL; j++) {\n          let currentTile = this.grids[i][j]\n          let j1 = j + 1\n          while (j1 < COL) {\n            let mergeTile = this.mergeTile({currentTile, row: i, col: j}, {i, j: j1})\n            if (mergeTile === true) {\n              break\n            } else {\n              currentTile = mergeTile\n              j1++\n            }\n          }\n        }\n      }\n    },\n    moveDown () {\n      for (let i = 0; i < ROW; i++) {\n        for (let j = COL - 1; j >= 0; j--) {\n          let currentTile = this.grids[i][j]\n          let j1 = j - 1\n          while (j1 >= 0) {\n            let mergeTile = this.mergeTile({currentTile, row: i, col: j}, {i, j: j1})\n            if (mergeTile === true) {\n              break\n            } else {\n              currentTile = mergeTile\n              j1--\n            }\n          }\n        }\n      }\n    },\n    mergeTile (current, neighbor) {\n      let {currentTile, row, col} = current\n      let {i, j} = neighbor\n      let isMerge = false\n      if (currentTile) {\n        if (this.grids[i][j]) {\n          if (this.grids[i][j].val === currentTile.val) {\n            currentTile.val = currentTile.val * 2\n            this.grids[i][j] = null\n          }\n          isMerge = true\n        }\n      } else if (this.grids[i][j]) {\n        currentTile = this.grids[i][j]\n        this.grids[i][j] = null\n      }\n      if (currentTile) {\n        this.grids[row][col] = {\n          val: currentTile.val,\n          rect: this.getBoundingClientRect(row, col)\n        }\n      }\n      if (isMerge) {\n        return true\n      }\n      return currentTile\n    }\n  },\n  mounted () {\n    this.initChessBoard()\n    this.$on('movingtiles', this.moving)\n\n    // 开始游戏\n    this.start()\n  }\n}\n\nfunction getListener () {\n  let startX, startY\n  return {\n    touchstart: (e) => {\n      // 防止滑动时，移动端页面上下抖动\n      e.preventDefault()\n      startX = e.touches[0].pageX\n      startY = e.touches[0].pageY\n    },\n    touchend: (e) => {\n      e.preventDefault()\n\n      let direction = null\n      let endX = e.changedTouches[0].pageX\n      let endY = e.changedTouches[0].pageY\n      let horizontal = endX - startX\n      let vertical = endY - startY\n      // 当touchend坐标偏移小于5像素时，不触发movingtiles事件。\n      if (Math.abs(horizontal) <= 5 && Math.abs(vertical) <= 5) {\n        return\n      }\n      if (Math.abs(horizontal) > Math.abs(vertical)) {\n        if (horizontal > 0) {\n          direction = 'RIGHT'\n        } else if (horizontal < 0) {\n          direction = 'LEFT'\n        }\n      } else if (Math.abs(horizontal) < Math.abs(vertical)) {\n        if (vertical > 0) {\n          direction = 'DOWN'\n        } else if (vertical < 0) {\n          direction = 'UP'\n        }\n      }\n      this.$emit('movingtiles', direction)\n    },\n    keydown: (e) => {\n      switch (e.keyCode) {\n        case KEYDOWN.UP:\n          this.$emit('movingtiles', 'UP')\n          break\n        case KEYDOWN.RIGHT:\n          this.$emit('movingtiles', 'RIGHT')\n          break\n        case KEYDOWN.DOWN:\n          this.$emit('movingtiles', 'DOWN')\n          break\n        case KEYDOWN.LEFT:\n          this.$emit('movingtiles', 'LEFT')\n          break\n      }\n    }\n  }\n}\n</script>\n<style lang=\"less\">\n  .Custom2048 {\n    canvas {\n      position: absolute;\n      top: 120px;\n      left: 50%;\n      transform: translateX(-50%);\n      display: block;\n      border-radius: 6px;\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Custom2048/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"Custom2048\"},[_c('canvas',{ref:\"chessBoard\",attrs:{\"width\":\"300px\",\"height\":\"300px\"}}),_vm._v(\" \"),_c('canvas',{ref:\"tiles\",attrs:{\"width\":\"300px\",\"height\":\"300px\"}})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-78a64ac0\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Custom2048/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-78a64ac0\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-78a64ac0\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Custom2048/index.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <Custom2048\n      ref=\"custom2048\"\n      class=\"custom2048-outer-container\"\n      @changescore=\"handleChangeScore\"\n      @gameover=\"handleGameover\"></Custom2048>\n    <div class=\"menu-container\">\n      <div class=\"score-container\">\n        <div class=\"block current-score\">\n          得分\n          <span>{{score}}</span>\n        </div>\n        <div class=\"block history-score\">\n          最高分\n          <span>{{maxScore}}</span>\n        </div>\n      </div>\n      <span class=\"block restart\" @click=\"handleRestart\">重新开始</span>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Custom2048 from 'components/Custom2048'\n\nexport default {\n  name: 'App',\n  components: {\n    Custom2048\n  },\n  data () {\n    return {\n      score: 0,\n      maxScore: window.localStorage.getItem('custom2048_score') || 0\n    }\n  },\n  watch: {\n    score (val) {\n      if (val > this.maxScore) {\n        this.maxScore = val\n        window.localStorage.setItem('custom2048_score', val)\n      }\n    }\n  },\n  methods: {\n    handleRestart () {\n      this.$nextTick(() => {\n        this.score = 0\n        this.$refs.custom2048.start()\n      })\n    },\n    handleChangeScore (awardedMarks) {\n      this.score += awardedMarks\n    },\n    handleGameover () {\n\n    }\n  }\n}\n</script>\n\n<style lang=\"less\">\n  body {\n    font-family: 'Microsoft YaHei';\n    background-color: #faf8ef;\n    .menu-container {\n      width: 300px;\n      margin: 0 auto;\n      text-align: right;\n    }\n    .block {\n      display: inline-block;\n      padding: 3px 12px;\n      height: 2;\n      text-align: center;\n      background-color: #8f7a66;\n      color: #f9f6f2;\n      border-radius: 6px;\n      font-size: 18px;\n      margin: 5px;\n    }\n    .score-container .block {\n      color: rgba(255,255,255,0.6);\n      font-size: 14px;\n      width: 48px;\n      background-color: rgba(143, 122, 102, .8);\n      span {\n        display: block;\n        color: white;\n      }\n    }\n    .restart {\n      width: 134px;\n      height: 36px;\n      line-height: 36px;\n      background-color: #d4430f;\n      &:active {\n        opacity: 0.8;\n      }\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('Custom2048',{ref:\"custom2048\",staticClass:\"custom2048-outer-container\",on:{\"changescore\":_vm.handleChangeScore,\"gameover\":_vm.handleGameover}}),_vm._v(\" \"),_c('div',{staticClass:\"menu-container\"},[_c('div',{staticClass:\"score-container\"},[_c('div',{staticClass:\"block current-score\"},[_vm._v(\"\\n        得分\\n        \"),_c('span',[_vm._v(_vm._s(_vm.score))])]),_vm._v(\" \"),_c('div',{staticClass:\"block history-score\"},[_vm._v(\"\\n        最高分\\n        \"),_c('span',[_vm._v(_vm._s(_vm.maxScore))])])]),_vm._v(\" \"),_c('span',{staticClass:\"block restart\",on:{\"click\":_vm.handleRestart}},[_vm._v(\"重新开始\")])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-62f3416f\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-62f3416f\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-62f3416f\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}